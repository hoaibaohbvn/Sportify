<!DOCTYPE html>
<html lang="en">

<head>
<title>SPORTIFY - Thông Tin Của Bạn</title>
<link rel="icon" href="/user/images/logotitle.png" type="image/x-icon">
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link
	href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,700;0,800;1,200;1,300;1,400;1,500;1,700&display=swap"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/user/css/animate.css">
<link rel="stylesheet" href="/user/css/owl.carousel.min.css">
<link rel="stylesheet" href="/user/css/owl.theme.default.min.css">
<link rel="stylesheet" href="/user/css/magnific-popup.css">
<link rel="stylesheet" href="/user/css/flaticon.css">
<link rel="stylesheet" href="/user/css/style.css">
<link rel="stylesheet" href="/user/css/styleprofile.css">
</head>

<body>

	<div class="wrap" style="z-index: 9; position: relative">
		<div class="container">
			<div class="row">
				<div class="col-md-6 d-flex align-items-center">
					<div class="social-media mr-4 m-1">
						<p class="mb-0 d-flex">
							<a href="#"
								class="d-flex align-items-center justify-content-center"><span
								class="fa fa-facebook"><i class="sr-only">Facebook</i></span></a> <a
								href="#"
								class="d-flex align-items-center justify-content-center"><span
								class="fa fa-twitter"><i class="sr-only">Twitter</i></span></a> <a
								href="#"
								class="d-flex align-items-center justify-content-center"><span
								class="fa fa-instagram"><i class="sr-only">Instagram</i></span></a>
							<a href="#"
								class="d-flex align-items-center justify-content-center"><span
								class="fa fa-dribbble"><i class="sr-only">Dribbble</i></span></a>
						</p>
					</div>
					<p class="mb-0 phone pl-md-2">
						<a href="#" class="mr-2"><span class="fa fa-phone mr-1"></span>
							+00 1234 567</a> <a href="#"><span class="fa fa-paper-plane mr-1"></span>
							youremail@email.com</a>
					</p>

				</div>

				<div class="col-md-6 d-flex justify-content-md-end">
					<!-- check login -->
					<!-- Thẻ div để hiển thị khi chưa đăng nhập -->
					<div th:if="${users == null}" class="reg m-1"
						style="display: block;">
						<p class="mb-0">
							<a th:href="@{/sportify/login}" class="mr-2"
								style="color: white;">Đăng nhập |</a> <a
								th:href="@{/sportify/signup}" style="color: white;">Đăng kí</a>
						</p>
					</div>

					<!-- Thẻ div để hiển thị khi đã đăng nhập -->
					<span th:if="${users != null}" class="m-1 mr-2"
						style="color: white;">Xin chào !</span>
					<div th:if="${users != null}" class="dropdown m-1"
						style="display: block;">
						<a class="dropdown-toggle " id="dropdownMenuAccount"
							data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							<img th:if=${users.image!=null}
							class="rounded-circle border border-white"
							th:src="@{'/user/images/' + ${users.image}}" alt=""
							style="width: 30px; height: 30px;"> <img
							th:if=${users.image==null}
							class="rounded-circle border border-white"
							src="/user/images/noavatar.jpg" alt=""
							style="width: 30px; height: 30px;"> <span id="nameuser"
							th:text="${users.firstname} + ' ' + ${users.lastname}"></span>
						</a>
						<div class="ml-3 mt-2 dropdown-menu"
							aria-labelledby="dropdownMenuButton">
							<a th:href="@{/sportify/profile}" class="dropdown-item">Thông
								tin</a> <a th:href="@{/sportify/field/profile/historybooking}"
								class="dropdown-item" href="#">Lịch sử đặt sân</a><a th:href="@{/sportify/order/historyList}"
								class="dropdown-item" href="#">Lịch sử đặt hàng</a> <a
								th:if="${authorized.roleid== 'R01' or authorized.roleid== 'R02'}"
								th:href="@{/sportify/admin}" class="dropdown-item">Quản trị</a>
							<a th:href="@{/sportify/logoff}" class="dropdown-item">Đăng
								xuất</a>
						</div>
					</div>

					<!-- end check login -->
				</div>

			</div>
		</div>
	</div>

	<nav
		class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light"
		id="ftco-navbar">
		<div class="container">
			<a class="navbar-brand" th:href="@{/sportify}"><img
				src="/user/images/Logo3.png" style="width: 350px;" alt=""></a>

			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#ftco-nav" aria-controls="ftco-nav"
				aria-expanded="false" aria-label="Toggle navigation">
				<span class="oi oi-menu"></span> Menu
			</button>

			<div class="collapse navbar-collapse" id="ftco-nav">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item"><a th:href="@{/sportify/field}"
						class="nav-link">Sân</a></li>
					<li class="nav-item"><a th:href="@{/sportify/team}"
						class="nav-link">Đội</a></li>
					<li class="nav-item"><a th:href="@{/sportify/event}"
						class="nav-link">Sự kiện</a></li>
					<li class="nav-item"><a th:href="@{/sportify/product}"
						class="nav-link">Cửa hàng</a></li>
					<li class="nav-item"><a th:href="@{/sportify/about}"
						class="nav-link">Về chúng tôi</a></li>
					<li class="nav-item"><a th:href="@{/sportify/contact}"
						class="nav-link">Liên hệ</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- END nav -->

	<div class="container d-flex justify-content-center rounded mt-5 mb-5 ">
		<div class=" col-md-12 bg-white d-flex rounded " id="profiles">
			<form th:action="@{/sportify/profile/save-profile}" method="post"
				class="d-flex" enctype="multipart/form-data">
				<div class="col-md-5">
					<div
						class="d-flex flex-column align-items-center text-center p-3 py-5">
						<div style="position: relative;">
							<img th:if="${profiles.image != null}" id="previewAvatar"
								class="border border-dark rounded-circle mt-5" width="250px"
								height="250px" th:src="@{'/user/images/' + ${profiles.image}}">
							<img th:if="${profiles.image==null}"
								class="border border-dark rounded-circle mt-5" width="250px"
								height="250px" src="../user/images/noavatar.jpg" alt="">
							<input type="hidden" name="avatarProfile"
								th:value="${profiles.image}">


							<div
								style="position: absolute; bottom: 0px; left: 50%; transform: translateX(-50%); z-index: 1;">
								<label for="avatarFileInput"> <i
									style="font-size: 25px; color: black;" class="fa fa-camera"></i>
									<!-- Sử dụng icon của Font Awesome, bạn có thể thay thế bằng biểu tượng tùy ý khác -->
								</label> <input style="display: none" id="avatarFileInput"
									class="form-control-file" type="file" value="macdinh.jpg"
									name="avatarFile" accept="image/*">
							</div>
						</div>
						<br>
						<h3 class="" th:text="${profiles.firstname}+' ' + ${profiles.lastname}"></h3>
						<span class=" font-weight-bold rounded"
							style="padding: 3px; color: #4682A9; margin-bottom: 10%"
							th:text="${roleuserOnl}"></span>




					</div>
				</div>
				<div class="col-md-6">
					<div class="p-3 py-5">
						<div
							class="d-flex justify-content-between align-items-center mb-3">
							<h4 class="text-right text-uppercase">Thông tin cá nhân</h4>
						</div>
						<div class="row">
							<div class="col-md-6">
								<label class="labels">Họ</label> <span class="text-danger">*</span>
								<input type="text" class="form-control" name="firstname"
									onblur="validateFirstName(this)"
									th:value="${profiles.firstname}">
								<div id="firstname-error" class="error-message text-danger"></div>
							</div>
							<div class="col-md-6">
								<label class="labels">Tên</label> <span class="text-danger">*</span>
								<input type="text" class="form-control" name="lastname"
									onblur="validateLastName(this)" th:value="${profiles.lastname}">
								<div id="lastname-error" class="error-message text-danger"></div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-12">
								<label class="labels">Tài khoản</label> <input type="text"
									class="form-control" readonly name="username"
									th:value="${profiles.username}">
							</div>



							<div class="col-md-12">
								<label class="labels">Mật khẩu</label>

								<div class="d-flex">
									<input readonly type="password" class="form-control col-md-12"
										name="passwords" th:value="${profiles.passwords}"><a
										class=" col-md-5" data-toggle="collapse" 
										href="#collapseExample" role="button" aria-expanded="false"
										aria-controls="collapseExample"> <i class="fa fa-edit"></i></a>
									</input>
								</div>
							</div>


							<div class="collapse" id="collapseExample">
								<div class="col-md-12">
									<label class="labels"
										style="float: left; width: 250px; text-align: justify; margin-right: 10px;">Mật
										khẩu mới:</label> <input onblur="validatePasswordMatch()"
										type="password" class="form-control" name="newpassword">
									<div id="password-match-error"
										class="error-message text-danger"></div>

								</div>
								<div class="col-md-12">
									<label class="labels"
										style="float: left; width: 250px; text-align: justify; margin-right: 10px;">Xác
										thực mật khẩu mới:</label> <input onblur="validatePasswordMatch()"
										type="password" class="form-control" name="confirmpassword">
									<div id="password-match-error"
										class="error-message text-danger"></div>
								</div>
							</div>

							<div class="col-md-12">
								<label class="labels">Số điện thoại</label> <span
									class="text-danger">*</span> <input type="text"
									class="form-control" name="phone" onblur="validatePhone(this)"
									th:value="${profiles.phone}">
								<div id="phone-error" class="error-message text-danger"></div>
							</div>
							<div class="col-md-12">
								<label class="labels">Email</label> <input type="text"
									class="form-control" name="email" onblur="validateEmail(this)"
									th:value="${profiles.email}">
								<div id="email-error" class="error-message text-danger"></div>
							</div>
							<div class="col-md-12">
								<label class="labels">Giới tính</label> <span
									class="text-danger">*</span>
								<div class="d-flex">
									<div class="radio-container mr-4">
										<input type="radio" name="gender" id="male" value="true"
											class="form-control mr-1"
											th:checked="${profiles.gender} == true" /> <span>Nam</span>
									</div>
									<div class="radio-container">
										<input type="radio" name="gender" id="female" value="false"
											class="form-control mr-1"
											th:checked="${profiles.gender} == false" /> <span>Nữ</span>
									</div>
								</div>

							</div>


							<div class="col-md-12">
								<label class="labels">Địa chỉ</label> <input type="text"
									class="form-control" name="address"
									onblur="validateAddress(this)" th:value="${profiles.address}">
								<div id="address-error" class="error-message text-danger"></div>
							</div>
						</div>
						<div class="mt-5 text-center">
							<button onclick="validateFormAndSubmit()"
								class="btn btn-outline-success" type="submit">Cập nhật
								hồ sơ</button>
						</div>

					</div>
				</div>
			</form>
		</div>
	</div>

	<!-- Đoạn mã để hiển thị thông báo nếu có -->
	<div class="col-12 fixed-top" id="messageDiv" th:if="${message}"
		style="display: none;">
		<div class="col-3 alert alert-success"
			style="position: fixed; top: 0px; right: 0px; z-index: 9999; font-size: 20px;">
			<p th:text="${message}"></p>

		</div>
	</div>
	<div class="col-12 fixed-top" id="messageDiv1" th:if="${message1}"
		style="display: none;">
		<div class="col-3 alert alert-danger "
			style="position: fixed; top: 0px; right: 0px; z-index: 9999; font-size: 20px;">
			<p th:text="${message1}"></p>

		</div>
	</div>

	<!-- loader -->
	<div id="ftco-loader" class="show fullscreen">
		<svg class="circular" width="48px" height="48px">
			<circle class="path-bg" cx="24" cy="24" r="22" fill="none"
				stroke-width="4" stroke="#eeeeee" />
			<circle class="path" cx="24" cy="24" r="22" fill="none"
				stroke-width="4" stroke-miterlimit="10" stroke="#F96D00" />
		</svg>
	</div>


	<script src="/user/js/jquery.min.js"></script>
	<script src="/user/js/angular.min.js"></script>
	<script src="/user/js/jquery-migrate-3.0.1.min.js"></script>
	<script src="/user/js/popper.min.js"></script>
	<script src="/user/js/bootstrap.min.js"></script>
	<script src="/user/js/jquery.easing.1.3.js"></script>
	<script src="/user/js/jquery.waypoints.min.js"></script>
	<script src="/user/js/jquery.stellar.min.js"></script>
	<script src="/user/js/owl.carousel.min.js"></script>
	<script src="/user/js/jquery.magnific-popup.min.js"></script>
	<script src="/user/js/jquery.animateNumber.min.js"></script>
	<script src="/user/js/scrollax.min.js"></script>
	<script
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
	<script src="/user/js/google-map.js"></script>
	<script src="/user/js/main.js"></script>

	<script>
		const avatarInput = document.getElementById('avatarInput');
		const previewAvatar = document.getElementById('previewAvatar');

		avatarInput.addEventListener('change', function(event) {
			const file = event.target.files[0];

			if (file) {
				previewAvatar.style.display = 'block';
				const reader = new FileReader();

				reader.onload = function(e) {
					previewAvatar.setAttribute('src', e.target.result);
				}

				reader.readAsDataURL(file);
			} else {
				previewAvatar.style.display = 'none';
				previewAvatar.removeAttribute('src');
			}
		});
	</script>

	<script>
		var regexVietnameseName = /^[\p{L}\s]*$/u; // Biểu thức chính quy cho Họ và Tên tiếng Việt
		var check = true;
		 const newPasswordInput = document.getElementsByName('newpassword')[0];
		    const confirmPasswordInput = document.getElementsByName('confirmpassword')[0];
		    const errorDiv = document.getElementById('password-match-error');
		    const submitButton = document.getElementById('submitBtn');

		    newPasswordInput.addEventListener('input', validatePassword);
		    confirmPasswordInput.addEventListener('input', validatePassword);
		    
		function validateFirstName(input) {
			var value = input.value;
			var errorDiv = document.getElementById('firstname-error');

			if (value.trim() === '') {
				errorDiv.textContent = 'Họ không được để trống';
				return check = false;
			} else if (!regexVietnameseName.test(value)) {
				errorDiv.textContent = 'Không nhập số hoặc ký tự đặc biệt như: !@#.,';
				return check = false;
			}else if(value.length > 50) {
				errorDiv.textContent = 'Không được quá 50 ký tự';
				return check = false;
			}
				
			else {
				errorDiv.textContent = ''; // Xóa thông báo lỗi khi hợp lệ
				return check = true;
			}
		}
		function validateLastName(input) {
			var value = input.value;
			var errorDiv = document.getElementById('lastname-error');

			if (value.trim() === '') {
				errorDiv.textContent = 'Tên không được để trống';
				return check = false;
			} else if (!regexVietnameseName.test(value)) {
				errorDiv.textContent = 'Không nhập số hoặc ký tự đặc biệt như: !@#.,';
				return check = false;
			}else if(value.length > 50) {
				errorDiv.textContent = 'Không được quá 50 ký tự';
				return check = false;
			} else {
				errorDiv.textContent = ''; // Xóa thông báo lỗi khi hợp lệ
				return check = true;
			}
		}
		function validateEmail(input) {
			var value = input.value;
			var errorDiv = document.getElementById('email-error');

			if (!/^$|^[\w\.-]+@[\w\.-]+\.\w{2,}$/.test(value)) {
				errorDiv.textContent = 'Email không hợp lệ';
				return check = false;
			}else if (value.trim() === '') {
				errorDiv.textContent = 'Email không được để trống';
				return check = false;
			} else {
				errorDiv.textContent = ''; // Xóa thông báo lỗi khi hợp lệ
				return check = true;
			}
		}
		function validatePhone(input) {
			var value = input.value;
			var errorDiv = document.getElementById('phone-error');

			if (value.trim() === '') {
				errorDiv.textContent = 'Số điện thoại không được để trống';
				return check = false;
			} else if (!/^(0?)(3[2-9]|5[6|8|9]|7[0|6-9]|8[0-6|8|9]|9[0-4|6-9])[0-9]{7}$/
					.test(value)) {
				errorDiv.textContent = 'Không đúng số điện thoại Việt Nam';
				return check = false;
			} else {
				errorDiv.textContent = ''; // Xóa thông báo lỗi khi hợp lệ
				return check = true;
			}
		}
		function validateAddress(input) {
			var value = input.value;
			var errorDiv = document.getElementById('address-error');

			if (!/^$|^[\p{L}0-9\s.,/-]+$/u.test(value)) {
				errorDiv.textContent = 'Địa chỉ không hợp lệ';
				return check = false;
			}else if (value.trim() === '') {
				errorDiv.textContent = 'Địa chỉ không được để trống';
				return check = false;
			} else {
				errorDiv.textContent = ''; // Xóa thông báo lỗi khi hợp lệ
				return check = true;
			}
		}
		function validatePassword() {
	        const newPassword = newPasswordInput.value;
	        const confirmPassword = confirmPasswordInput.value;
	        var errorDiv = document.getElementById('password-match-error');
	        var errorDiv = document.getElementById('password-match-error');
	        if (newPassword.length < 6 || newPassword.length > 16) {
	            errorDiv.textContent = 'Mật khẩu phải từ 6 đến 16 ký tự';
	            return check = false;
	            
	           
	        }else if(confirmPassword.length < 6 || confirmPassword.length > 16){
	        	errorDiv.textContent = 'Mật khẩu phải từ 6 đến 16 ký tự';
	            return check = false;
	        }else if (newPassword !== confirmPassword) {
	            errorDiv.textContent = 'Mật khẩu mới và xác thực không khớp';
	            return check = false;
	         
	        } else {
	            errorDiv.textContent = '';
	            return check = true;
	            
	        }
	    }
		function validateFormAndSubmit() {

			// Kiểm tra trạng thái của biến check
			if (check) {

				// Tất cả dữ liệu hợp lệ, thực hiện submit
				document.querySelector('form').submit();
			} else {
				event.preventDefault();
			}
		}
	</script>

</body>

</html>